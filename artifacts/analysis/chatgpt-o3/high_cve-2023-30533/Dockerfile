# ---- Base image ------------------------------------------------------------
FROM node:18-slim

# ---- Create work dir & init package.json -----------------------------------
WORKDIR /app
RUN npm init -y

# ---- Install vulnerable xlsx + helper library ------------------------------
RUN npm install xlsx@0.18.5 jszip@3.10.1         \
 && npm cache clean --force

# ---- Copy PoC & exploit script ---------------------------------------------
# 如果你已经下载了 threaded_comment_bad.xlsx，请保持同名；否则用 curl 下载：
COPY threaded_comment_bad.xlsx .
COPY exploit.js .

CMD ["node", "exploit.js"]
